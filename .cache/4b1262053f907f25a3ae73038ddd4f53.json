{"dependencies":[],"generated":{"js":"const API_URL = \"http://localhost:8080/\";\n\nconst TIMESLOTS = [\"06:00\", \"07:00\", \"08:00\", \"09:00\", \"10:00\", \"11:00\", \"12:00\", \"13:00\", \"14:00\", \"15:00\", \"16:00\", \"17:00\", \"18:00\", \"19:00\", \"20:00\", \"21:00\", \"22:00\", \"23:00\"];\n\n$(document).ready(function () {\n  TIMESLOTS.forEach(i => {\n    $(\"#startTime\").append(`\n        <option value='${i}'> ${i} </option>`);\n    $(\"#endTime\").append(`\n        <option value='${i}'> ${i} </option>`);\n  });\n  getProviders();\n  $(\"#serviceProvider\").change(() => {\n    $(\"#selectSlots\").css(\"display\", \"block\");\n    var provider_id = $(\"input[name='serviceProvider']:checked\").val();\n    handleExistingTimeslots(provider_id);\n  });\n  $(\"form\").append('<button type=\"submit\">Submit</button>');\n  $(\"form\").submit(e => {\n    e.preventDefault();\n    handleSubmit();\n  });\n  $(\"#reminderPage\").click(() => {\n    var provider_id = $(\"input[name='serviceProvider']:checked\").val();\n    if (provider_id) {\n      window.location = 'reminder.html?provider_id=' + provider_id;\n    } else {\n      alert(\"Please select the type of provider you are!\");\n    }\n  });\n  $(\"#ordersPage\").click(() => {\n    var provider_id = $(\"input[name='serviceProvider']:checked\").val();\n    if (provider_id) {\n      window.location = 'orders.html?provider_id=' + provider_id;\n    } else {\n      alert(\"Please select the type of provider you are!\");\n    }\n  });\n});\n\nfunction getProviders() {\n  $.ajax({\n    url: `${API_URL}api/provider`,\n    type: \"GET\",\n    crossDomain: true\n  }).done(response => {\n    var providers = response.providers;\n    for (var i = 0; i < providers.length; i++) {\n      var title = providers[i].title;\n      var id = providers[i].id;\n      $(\"#serviceProvider\").append(`\n                <label class=\"serviceProvider\"> \n                    <input type=\"radio\" name=\"serviceProvider\" value=${id}>\n                    ${title}\n                </label>\n            `);\n    }\n  });\n}\n\nfunction handleSubmit() {\n  var start_time = $(\"#startTime\").val();\n  var end_time = $(\"#endTime\").val();\n  var provider_id = $(\"input[name='serviceProvider']:checked\").val();\n  if (start_time && end_time && provider_id) {\n    var result = $.param({\n      start_time: start_time,\n      end_time: end_time,\n      provider_id: provider_id\n    });\n    console.log(result);\n    $.ajax({\n      url: `${API_URL}api/time_slot`,\n      type: \"POST\",\n      data: result,\n      crossDomain: true,\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      }\n    }).done(data => {\n      handleExistingTimeslots(provider_id);\n    }).fail(err => {\n      if (err.status == 500) {\n        alert('You already have an overlapping slot registered.');\n      }\n      if (err.status == 400) {\n        alert('Something went wrong.');\n      }\n    });\n  } else {\n    alert(\"Make sure you've selected a timeslot!\");\n  }\n};\n\nfunction handleExistingTimeslots(provider_id) {\n  $(\"#timeSlots\").empty();\n  $.ajax({\n    url: `${API_URL}/api/provider/` + provider_id,\n    type: \"GET\"\n  }).done(response => {\n    var times = [];\n    for (i in response.slots) {\n      var slot = response.slots[i];\n      var startTime = slot.start_time.match(/\\d{2}:00(?=:00Z)/);\n      var endTime = slot.end_time.match(/\\d{2}:00(?=:00Z)/);\n      times[startTime] = endTime[0];\n    }\n    var sorted = [];\n    sorted = Object.keys(times).sort((a, b) => {\n      return a > b;\n    });\n    for (var i = 0; i < sorted.length; i++) {\n      var start = sorted[i];\n      addTimeSlot(start, times[start]);\n    }\n  });\n}\n\nfunction addTimeSlot(start, end) {\n  $(\"#timeSlots\").append(`\n    <li> \n        <span class=\"startTime\"> ${start} </span>\n            -\n        <span class=\"endTime\"> ${end} </span>\n    </li>\n    `);\n}"},"hash":"49b30cfd229bbde185dfa8013e01d6c0"}